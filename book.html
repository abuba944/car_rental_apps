<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Book {{ car['name'] }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <h2>BOOK {{ car['name'] }}</h2>

    <div class="car-card">
        <img src="{{ car['image_url'] }}" alt="{{ car['name'] }}">
        <p><strong>Color:</strong> {{ car['color'] }}</p>
        <p><strong>Speed:</strong> {{ car['speed'] }}</p>
        <p><strong>Price per day:</strong> ₦{{ car['price_per_day'] }}</p>
        <p><strong>Location:</strong> {{ car['location'] }}</p>
        <p>{{ car['description'] }}</p>
    </div>

    <h3>Enter Your Information to Book</h3>

    <form method="POST" id="booking-form">
        <input type="text" name="fullname" placeholder="Full Name" required><br>
        <input type="email" name="email" id="email" placeholder="Email Address" required><br>
        <input type="tel" name="phone" placeholder="Phone Number" required><br>

        <button type="button" onclick="payWithPaystack()">Pay Now</button>
    </form>

    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script>
      function payWithPaystack() {
        let email = document.getElementById('email').value;
        let amount = {{ car['price_per_day'] | tojson }} * 100;

        if (!email) {
          alert("Please enter your email.");
          return;
        }

        let handler = PaystackPop.setup({
          key: 'pk_test_4ea84a11a09d22dee4861fbff5fab017b8a77d98', // Use your test/live key
          email: email,
          amount: amount,
          currency: 'NGN',
          ref: '' + Math.floor(Math.random() * 1000000000 + 1), // Unique transaction ref
          callback: function(response) {
            alert("Payment successful! Ref: " + response.reference);
            document.getElementById('booking-form').submit(); // Submit form
          },
          onClose: function() {
            alert("Payment cancelled.");
          }
        });

        handler.openIframe();
      }
    </script>

    <br>
    <a href="/">~ Back to Home</a>
    <footer class="site-footer">
  <div class="footer-container">
    <div class="footer-section">
      <h4>About Us</h4>
      <p>Jimoh's Car Rentals is a reliable service offering affordable and fast cars across Nigeria. Our aim is to deliver quality and comfort.</p>
    </div>
    <div class="footer-section">
      <h4>Terms & Conditions</h4>
      <p>Renter must be 21 years or older. Valid driver’s license is required. Cars must be returned in good condition to avoid penalties.</p>
    </div>
    <div class="footer-section">
      <h4>Contact</h4>
      <p>Email: support@jimohcarrentals.com<br>Phone: +234 801 234 5678</p>
    </div>
  </div>
  <p class="copyright">© 2025 Jimoh Car Rental. All rights reserved.</p>
</footer>
</body>
</html>